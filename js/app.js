/*! For license information please see app.js.LICENSE.txt */
(()=>{var r={437:(r,e,n)=>{var t,o=function(r){var e="b",n="w",t=-1,o="p",i="k",a="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",l=["1-0","0-1","1/2-1/2","*"],u={b:[16,32,17,15],w:[-16,-32,-17,-15]},f={n:[-18,-33,-31,-14,18,33,31,14],b:[-17,-15,17,15],r:[-16,1,16,-1],q:[-17,-16,-15,1,17,16,15,-1],k:[-17,-16,-15,1,17,16,15,-1]},s=[20,0,0,0,0,0,0,24,0,0,0,0,0,0,20,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,24,24,24,24,24,24,56,0,56,24,24,24,24,24,24,0,0,0,0,0,0,2,53,56,53,2,0,0,0,0,0,0,0,0,0,0,0,20,2,24,2,20,0,0,0,0,0,0,0,0,0,0,20,0,0,24,0,0,20,0,0,0,0,0,0,0,0,20,0,0,0,24,0,0,0,20,0,0,0,0,0,0,20,0,0,0,0,24,0,0,0,0,20,0,0,0,0,20,0,0,0,0,0,24,0,0,0,0,0,20,0,0,20,0,0,0,0,0,0,24,0,0,0,0,0,0,20],c=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,0,16,0,15,0,0,0,0,0,0,0,0,0,0,0,0,17,16,15,0,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-15,-16,-17,0,0,0,0,0,0,0,0,0,0,0,0,-15,0,-16,0,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],p={p:0,n:1,b:2,r:3,q:4,k:5},v={NORMAL:"n",CAPTURE:"c",BIG_PAWN:"b",EP_CAPTURE:"e",PROMOTION:"p",KSIDE_CASTLE:"k",QSIDE_CASTLE:"q"},g={NORMAL:1,CAPTURE:2,BIG_PAWN:4,EP_CAPTURE:8,PROMOTION:16,KSIDE_CASTLE:32,QSIDE_CASTLE:64},h={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},d={w:[{square:h.a1,flag:g.QSIDE_CASTLE},{square:h.h1,flag:g.KSIDE_CASTLE}],b:[{square:h.a8,flag:g.QSIDE_CASTLE},{square:h.h8,flag:g.KSIDE_CASTLE}]},b=new Array(128),m={w:t,b:t},E=n,_={w:0,b:0},w=t,C=0,A=1,S=[],k={};function y(r){void 0===r&&(r=!1),b=new Array(128),m={w:t,b:t},E=n,_={w:0,b:0},w=t,C=0,A=1,S=[],r||(k={}),O(D())}function T(){I(a)}function I(r,o){void 0===o&&(o=!1);var i=r.split(/\s+/),a=i[0],l=0;if(!P(r).valid)return!1;y(o);for(var u=0;u<a.length;u++){var f=a.charAt(u);if("/"===f)l+=8;else if(-1!=="0123456789".indexOf(f))l+=parseInt(f,10);else{var s=f<"a"?n:e;N({type:f.toLowerCase(),color:s},V(l)),l++}}return E=i[1],i[2].indexOf("K")>-1&&(_.w|=g.KSIDE_CASTLE),i[2].indexOf("Q")>-1&&(_.w|=g.QSIDE_CASTLE),i[2].indexOf("k")>-1&&(_.b|=g.KSIDE_CASTLE),i[2].indexOf("q")>-1&&(_.b|=g.QSIDE_CASTLE),w="-"===i[3]?t:h[i[3]],C=parseInt(i[4],10),A=parseInt(i[5],10),O(D()),!0}function P(r){var e=r.split(/\s+/);if(6!==e.length)return{valid:!1,error_number:1,error:"FEN string must contain six space-delimited fields."};if(isNaN(e[5])||parseInt(e[5],10)<=0)return{valid:!1,error_number:2,error:"6th field (move number) must be a positive integer."};if(isNaN(e[4])||parseInt(e[4],10)<0)return{valid:!1,error_number:3,error:"5th field (half move counter) must be a non-negative integer."};if(!/^(-|[abcdefgh][36])$/.test(e[3]))return{valid:!1,error_number:4,error:"4th field (en-passant square) is invalid."};if(!/^(KQ?k?q?|Qk?q?|kq?|q|-)$/.test(e[2]))return{valid:!1,error_number:5,error:"3rd field (castling availability) is invalid."};if(!/^(w|b)$/.test(e[1]))return{valid:!1,error_number:6,error:"2nd field (side to move) is invalid."};var n=e[0].split("/");if(8!==n.length)return{valid:!1,error_number:7,error:"1st field (piece positions) does not contain 8 '/'-delimited rows."};for(var t=0;t<n.length;t++){for(var o=0,i=!1,a=0;a<n[t].length;a++)if(isNaN(n[t][a])){if(!/^[prnbqkPRNBQK]$/.test(n[t][a]))return{valid:!1,error_number:9,error:"1st field (piece positions) is invalid [invalid piece]."};o+=1,i=!1}else{if(i)return{valid:!1,error_number:8,error:"1st field (piece positions) is invalid [consecutive numbers]."};o+=parseInt(n[t][a],10),i=!0}if(8!==o)return{valid:!1,error_number:10,error:"1st field (piece positions) is invalid [row too large]."}}return"3"==e[3][1]&&"w"==e[1]||"6"==e[3][1]&&"b"==e[1]?{valid:!1,error_number:11,error:"Illegal en-passant square"}:{valid:!0,error_number:0,error:"No errors."}}function D(){for(var r=0,e="",o=h.a8;o<=h.h1;o++){if(null==b[o])r++;else{r>0&&(e+=r,r=0);var i=b[o].color,a=b[o].type;e+=i===n?a.toUpperCase():a.toLowerCase()}o+1&136&&(r>0&&(e+=r),o!==h.h1&&(e+="/"),r=0,o+=8)}var l="";_.w&g.KSIDE_CASTLE&&(l+="K"),_.w&g.QSIDE_CASTLE&&(l+="Q"),_.b&g.KSIDE_CASTLE&&(l+="k"),_.b&g.QSIDE_CASTLE&&(l+="q"),l=l||"-";var u=w===t?"-":V(w);return[e,E,l,u,C,A].join(" ")}function L(r){for(var e=0;e<r.length;e+=2)"string"==typeof r[e]&&"string"==typeof r[e+1]&&(k[r[e]]=r[e+1]);return k}function O(r){S.length>0||(r!==a?(k.SetUp="1",k.FEN=r):(delete k.SetUp,delete k.FEN))}function R(r){var e=b[h[r]];return e?{type:e.type,color:e.color}:null}function N(r,e){if(!("type"in r)||!("color"in r))return!1;if(-1==="pnbrqkPNBRQK".indexOf(r.type.toLowerCase()))return!1;if(!(e in h))return!1;var n=h[e];return(r.type!=i||m[r.color]==t||m[r.color]==n)&&(b[n]={type:r.type,color:r.color},r.type===i&&(m[r.color]=n),O(D()),!0)}function q(r,e,n,t,i){var a={color:E,from:e,to:n,flags:t,piece:r[e].type};return i&&(a.flags|=g.PROMOTION,a.promotion=i),r[n]?a.captured=r[n].type:t&g.EP_CAPTURE&&(a.captured=o),a}function K(r){function e(r,e,n,t,i){if(r[n].type!==o||0!==Z(t)&&7!==Z(t))e.push(q(r,n,t,i));else for(var a=["q","r","b","n"],l=0,u=a.length;l<u;l++)e.push(q(r,n,t,i,a[l]))}var n=[],t=E,i=X(t),a={b:1,w:6},l=h.a8,s=h.h1,c=!1,p=void 0===r||!("legal"in r)||r.legal;if(void 0!==r&&"square"in r){if(!(r.square in h))return[];l=s=h[r.square],c=!0}for(var v=l;v<=s;v++)if(136&v)v+=7;else{var d=b[v];if(null!=d&&d.color===t)if(d.type===o){var C=v+u[t][0];for(null==b[C]&&(e(b,n,v,C,g.NORMAL),C=v+u[t][1],a[t]===Z(v)&&null==b[C]&&e(b,n,v,C,g.BIG_PAWN)),A=2;A<4;A++)136&(C=v+u[t][A])||(null!=b[C]&&b[C].color===i?e(b,n,v,C,g.CAPTURE):C===w&&e(b,n,v,w,g.EP_CAPTURE))}else for(var A=0,S=f[d.type].length;A<S;A++){var k=f[d.type][A];for(C=v;!(136&(C+=k));){if(null!=b[C]){if(b[C].color===t)break;e(b,n,v,C,g.CAPTURE);break}if(e(b,n,v,C,g.NORMAL),"n"===d.type||"k"===d.type)break}}}if(!c||s===m[t]){if(_[t]&g.KSIDE_CASTLE){var y=(T=m[t])+2;null!=b[T+1]||null!=b[y]||Q(i,m[t])||Q(i,T+1)||Q(i,y)||e(b,n,m[t],y,g.KSIDE_CASTLE)}var T;if(_[t]&g.QSIDE_CASTLE)y=(T=m[t])-2,null!=b[T-1]||null!=b[T-2]||null!=b[T-3]||Q(i,m[t])||Q(i,T-1)||Q(i,y)||e(b,n,m[t],y,g.QSIDE_CASTLE)}if(!p)return n;var I=[];for(v=0,S=n.length;v<S;v++)H(n[v]),U(t)||I.push(n[v]),F();return I}function $(r,e){var n="";if(r.flags&g.KSIDE_CASTLE)n="O-O";else if(r.flags&g.QSIDE_CASTLE)n="O-O-O";else{var t=function(r,e){for(var n=K({legal:!e}),t=r.from,o=r.to,i=r.piece,a=0,l=0,u=0,f=0,s=n.length;f<s;f++){var c=n[f].from,p=n[f].to;i===n[f].piece&&t!==c&&o===p&&(a++,Z(t)===Z(c)&&l++,J(t)===J(c)&&u++)}return a>0?l>0&&u>0?V(t):u>0?V(t).charAt(1):V(t).charAt(0):""}(r,e);r.piece!==o&&(n+=r.piece.toUpperCase()+t),r.flags&(g.CAPTURE|g.EP_CAPTURE)&&(r.piece===o&&(n+=V(r.from)[0]),n+="x"),n+=V(r.to),r.flags&g.PROMOTION&&(n+="="+r.promotion.toUpperCase())}return H(r),M()&&(B()?n+="#":n+="+"),F(),n}function x(r){return r.replace(/=/,"").replace(/[+#]?[?!]*$/,"")}function Q(r,t){for(var i=h.a8;i<=h.h1;i++)if(136&i)i+=7;else if(null!=b[i]&&b[i].color===r){var a=b[i],l=i-t,u=l+119;if(s[u]&1<<p[a.type]){if(a.type===o){if(l>0){if(a.color===n)return!0}else if(a.color===e)return!0;continue}if("n"===a.type||"k"===a.type)return!0;for(var f=c[u],v=i+f,g=!1;v!==t;){if(null!=b[v]){g=!0;break}v+=f}if(!g)return!0}}return!1}function U(r){return Q(X(r),m[r])}function M(){return U(E)}function B(){return M()&&0===K().length}function j(){return!M()&&0===K().length}function W(){for(var r={},e=[],n=0,t=0,o=h.a8;o<=h.h1;o++)if(t=(t+1)%2,136&o)o+=7;else{var i=b[o];i&&(r[i.type]=i.type in r?r[i.type]+1:1,"b"===i.type&&e.push(t),n++)}if(2===n)return!0;if(3===n&&(1===r.b||1===r.n))return!0;if(n===r.b+2){var a=0,l=e.length;for(o=0;o<l;o++)a+=e[o];if(0===a||a===l)return!0}return!1}function G(){for(var r=[],e={},n=!1;;){var t=F();if(!t)break;r.push(t)}for(;;){var o=D().split(" ").slice(0,4).join(" ");if(e[o]=o in e?e[o]+1:1,e[o]>=3&&(n=!0),!r.length)break;H(r.pop())}return n}function H(r){var n=E,a=X(n);if(function(r){S.push({move:r,kings:{b:m.b,w:m.w},turn:E,castling:{b:_.b,w:_.w},ep_square:w,half_moves:C,move_number:A})}(r),b[r.to]=b[r.from],b[r.from]=null,r.flags&g.EP_CAPTURE&&(E===e?b[r.to-16]=null:b[r.to+16]=null),r.flags&g.PROMOTION&&(b[r.to]={type:r.promotion,color:n}),b[r.to].type===i){if(m[b[r.to].color]=r.to,r.flags&g.KSIDE_CASTLE){var l=r.to-1,u=r.to+1;b[l]=b[u],b[u]=null}else r.flags&g.QSIDE_CASTLE&&(l=r.to+1,u=r.to-2,b[l]=b[u],b[u]=null);_[n]=""}if(_[n])for(var f=0,s=d[n].length;f<s;f++)if(r.from===d[n][f].square&&_[n]&d[n][f].flag){_[n]^=d[n][f].flag;break}if(_[a])for(f=0,s=d[a].length;f<s;f++)if(r.to===d[a][f].square&&_[a]&d[a][f].flag){_[a]^=d[a][f].flag;break}w=r.flags&g.BIG_PAWN?"b"===E?r.to-16:r.to+16:t,r.piece===o||r.flags&(g.CAPTURE|g.EP_CAPTURE)?C=0:C++,E===e&&A++,E=X(E)}function F(){var r=S.pop();if(null==r)return null;var n=r.move;m=r.kings,E=r.turn,_=r.castling,w=r.ep_square,C=r.half_moves,A=r.move_number;var t,i,a=E,l=X(E);if(b[n.from]=b[n.to],b[n.from].type=n.piece,b[n.to]=null,n.flags&g.CAPTURE)b[n.to]={type:n.captured,color:l};else if(n.flags&g.EP_CAPTURE){var u;u=a===e?n.to-16:n.to+16,b[u]={type:o,color:l}}return n.flags&(g.KSIDE_CASTLE|g.QSIDE_CASTLE)&&(n.flags&g.KSIDE_CASTLE?(t=n.to+1,i=n.to-1):n.flags&g.QSIDE_CASTLE&&(t=n.to-2,i=n.to+1),b[t]=b[i],b[i]=null),n}function z(r,e){var n=x(r);if(e){var t=n.match(/([pnbrqkPNBRQK])?([a-h][1-8])x?-?([a-h][1-8])([qrbnQRBN])?/);if(t)var o=t[1],i=t[2],a=t[3],l=t[4]}for(var u=K(),f=0,s=u.length;f<s;f++){if(n===x($(u[f]))||e&&n===x($(u[f],!0)))return u[f];if(t&&(!o||o.toLowerCase()==u[f].piece)&&h[i]==u[f].from&&h[a]==u[f].to&&(!l||l.toLowerCase()==u[f].promotion))return u[f]}return null}function Z(r){return r>>4}function J(r){return 15&r}function V(r){var e=J(r),n=Z(r);return"abcdefgh".substring(e,e+1)+"87654321".substring(n,n+1)}function X(r){return r===n?e:n}function Y(r){var e=rr(r);e.san=$(e,!1),e.to=V(e.to),e.from=V(e.from);var n="";for(var t in g)g[t]&e.flags&&(n+=v[t]);return e.flags=n,e}function rr(r){var e=r instanceof Array?[]:{};for(var n in r)e[n]="object"==typeof n?rr(r[n]):r[n];return e}function er(r){return r.replace(/^\s+|\s+$/g,"")}function nr(r){for(var e=K({legal:!1}),n=0,t=E,o=0,i=e.length;o<i;o++)H(e[o]),U(t)||(r-1>0?n+=nr(r-1):n++),F();return n}return I(void 0===r?a:r),{WHITE:n,BLACK:e,PAWN:o,KNIGHT:"n",BISHOP:"b",ROOK:"r",QUEEN:"q",KING:i,SQUARES:function(){for(var r=[],e=h.a8;e<=h.h1;e++)136&e?e+=7:r.push(V(e));return r}(),FLAGS:v,load:function(r){return I(r)},reset:function(){return T()},moves:function(r){for(var e=K(r),n=[],t=0,o=e.length;t<o;t++)void 0!==r&&"verbose"in r&&r.verbose?n.push(Y(e[t])):n.push($(e[t],!1));return n},in_check:function(){return M()},in_checkmate:function(){return B()},in_stalemate:function(){return j()},in_draw:function(){return C>=100||j()||W()||G()},insufficient_material:function(){return W()},in_threefold_repetition:function(){return G()},game_over:function(){return C>=100||B()||j()||W()||G()},validate_fen:function(r){return P(r)},fen:function(){return D()},board:function(){for(var r=[],e=[],n=h.a8;n<=h.h1;n++)null==b[n]?e.push(null):e.push({type:b[n].type,color:b[n].color}),n+1&136&&(r.push(e),e=[],n+=8);return r},pgn:function(r){var e="object"==typeof r&&"string"==typeof r.newline_char?r.newline_char:"\n",n="object"==typeof r&&"number"==typeof r.max_width?r.max_width:0,t=[],o=!1;for(var i in k)t.push("["+i+' "'+k[i]+'"]'+e),o=!0;o&&S.length&&t.push(e);for(var a=[];S.length>0;)a.push(F());for(var l=[],u="";a.length>0;){var f=a.pop();S.length||"b"!==f.color?"w"===f.color&&(u.length&&l.push(u),u=A+"."):u=A+". ...",u=u+" "+$(f,!1),H(f)}if(u.length&&l.push(u),void 0!==k.Result&&l.push(k.Result),0===n)return t.join("")+l.join(" ");var s=0;for(i=0;i<l.length;i++)s+l[i].length>n&&0!==i?(" "===t[t.length-1]&&t.pop(),t.push(e),s=0):0!==i&&(t.push(" "),s++),t.push(l[i]),s+=l[i].length;return t.join("")},load_pgn:function(r,e){var n=void 0!==e&&"sloppy"in e&&e.sloppy;function t(r){return r.replace(/\\/g,"\\")}var o="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\r?\n",i=new RegExp("^(\\[((?:"+t(o)+")|.)*\\])(?:"+t(o)+"){2}"),a=i.test(r)?i.exec(r)[1]:"";T();var u=function(r,e){for(var n="object"==typeof e&&"string"==typeof e.newline_char?e.newline_char:"\r?\n",o={},i=r.split(new RegExp(t(n))),a="",l="",u=0;u<i.length;u++)a=i[u].replace(/^\[([A-Z][A-Za-z]*)\s.*\]$/,"$1"),l=i[u].replace(/^\[[A-Za-z]+\s"(.*)"\]$/,"$1"),er(a).length>0&&(o[a]=l);return o}(a,e);for(var f in u)L([f,u[f]]);if(!("1"!==u.SetUp||"FEN"in u&&I(u.FEN,!0)))return!1;var s=r.replace(a,"").replace(new RegExp(t(o),"g")," ");s=s.replace(/(\{[^}]+\})+?/g,"");for(var c=/(\([^\(\)]+\))+?/g;c.test(s);)s=s.replace(c,"");var p=er(s=(s=(s=s.replace(/\d+\.(\.\.)?/g,"")).replace(/\.\.\./g,"")).replace(/\$\d+/g,"")).split(new RegExp(/\s+/));p=p.join(",").replace(/,,+/g,",").split(",");for(var v="",g=0;g<p.length-1;g++){if(null==(v=z(p[g],n)))return!1;H(v)}if(v=p[p.length-1],l.indexOf(v)>-1)(function(r){for(var e in r)return!0;return!1})(k)&&void 0===k.Result&&L(["Result",v]);else{if(null==(v=z(v,n)))return!1;H(v)}return!0},header:function(){return L(arguments)},ascii:function(){return function(){for(var r="   +------------------------+\n",e=h.a8;e<=h.h1;e++){if(0===J(e)&&(r+=" "+"87654321"[Z(e)]+" |"),null==b[e])r+=" . ";else{var t=b[e].type;r+=" "+(b[e].color===n?t.toUpperCase():t.toLowerCase())+" "}e+1&136&&(r+="|\n",e+=8)}return(r+="   +------------------------+\n")+"     a  b  c  d  e  f  g  h\n"}()},turn:function(){return E},move:function(r,e){var n=void 0!==e&&"sloppy"in e&&e.sloppy,t=null;if("string"==typeof r)t=z(r,n);else if("object"==typeof r)for(var o=K(),i=0,a=o.length;i<a;i++)if(r.from===V(o[i].from)&&r.to===V(o[i].to)&&(!("promotion"in o[i])||r.promotion===o[i].promotion)){t=o[i];break}if(!t)return null;var l=Y(t);return H(t),l},undo:function(){var r=F();return r?Y(r):null},clear:function(){return y()},put:function(r,e){return N(r,e)},get:function(r){return R(r)},remove:function(r){return function(r){var e=R(r);return b[h[r]]=null,e&&e.type===i&&(m[e.color]=t),O(D()),e}(r)},perft:function(r){return nr(r)},square_color:function(r){if(r in h){var e=h[r];return(Z(e)+J(e))%2==0?"light":"dark"}return null},history:function(r){for(var e=[],n=[],t=(void 0!==r&&"verbose"in r&&r.verbose);S.length>0;)e.push(F());for(;e.length>0;){var o=e.pop();t?n.push(Y(o)):n.push($(o)),H(o)}return n}}};e.Chess=o,void 0===(t=function(){return o}.call(e,n,e,r))||(r.exports=t)}},e={};function n(t){var o=e[t];if(void 0!==o)return o.exports;var i=e[t]={exports:{}};return r[t](i,i.exports,n),i.exports}n.n=r=>{var e=r&&r.__esModule?()=>r.default:()=>r;return n.d(e,{a:e}),e},n.d=(r,e)=>{for(var t in e)n.o(e,t)&&!n.o(r,t)&&Object.defineProperty(r,t,{enumerable:!0,get:e[t]})},n.o=(r,e)=>Object.prototype.hasOwnProperty.call(r,e),(()=>{"use strict";var r=n(437),e=n.n(r);const t=r=>{let e=0;for(;r>0;)e+=r%2,r=Math.floor(r/2);return 0==e%2?"w":"b"},o=function(r){const n="checkmate",o="draw",i="king taken",a="stalemate",l=new(e())(r);let u=!1,f=0;function s(){return l.in_checkmate()}function c(){return l.in_draw()}function p(){return l.in_stalemate()}function v(){return u}function g(r){return l.moves({square:r.from,verbose:!0}).some((e=>e.to===r.to))}return r&&(f=function(r){const e=r.split(" ");return Number(e[5])}(r)),{BLACK:"b",CHECK:"check",CHECKMATE:n,DRAW:o,KING_TAKEN:i,STALEMATE:a,WHITE:"w",activeColor:function(){return t(f)},board:function(){return l.board({verbose:!0})},fen:function(){return l.fen()},gameOver:function(){return v()?i:s()?n:c()?o:p()?a:null},inCheck:function(){return l.in_check()},inCheckmate:function(){return s()},inDraw:function(){return c()},inStalemate:function(){return p()},kingTaken:function(){return v()},legal:function(r){return g(r)},move:function(r){return function(r){if(!g({from:r.from,to:r.to}))return;const e=f+1,n=t(e),o=l.fen().split(" "),i=l.get(r.to);i&&"k"===i.type&&(u=!0);const a=l.move({from:r.from,to:r.to,promotion:"q"}),s=l.fen().split(" ");o[1]===n&&(s[3]="-"),s[1]=n,s[5]=e;const c=s.join(" ");return l.load(c),f=e,a}(r)},moves:function(r){return function(r){return l.moves(r)}(r)},turnNum:function(){return f}}};"undefined"!=typeof exports&&(exports.fairchess=o),"undefined"!=typeof define&&define((function(){return o}));const i={p:10,b:20,n:30,r:50,q:1e3,k:5e4};let a;function l(r){if(!r)return 0;const e=i[r.type];return"w"===r.color?e:-e}function u(r,e,n,t,i){++f;const a={fen:r.fen(),toMove:r.turnColor,val:0,children:[]};if(0===e||r.gameOver())return a.val=-function(r){let e=0;for(let n=0;n<8;++n)for(let t=0;t<8;++t)e+=l(r[n][t]);return e}(r.board()),a;const s=r.moves({verbose:!0});if(i){let i=-999999;for(let l=0;l<s.length;++l){const f=s[l],c=o(r.fen());c.move(f);const p=u(c,e-1,n,t,"w"===f.color),v=p.val;if(a.children.push(p),i=Math.max(i,v),i>=t)break;n=Math.max(n,i)}return a.val=i,a}{let i=999999;for(let l=0;l<s.length;++l){const f=s[l],c=o(r.fen());c.move(f);const p=u(c,e-1,n,t,"w"===f.color),v=p.val;if(a.children.push(p),i=Math.min(i,v),i<=n)break;t=Math.min(t,i)}return a.val=i,a}}let f=0;const s="square-highlight";let c=null,p=()=>{console.log("onDrop")},v=()=>{console.log("onDragStart")};function g(r,e,n,t,o,i){return p(r,e,n,t,o,i)}function h(r){if(null!==c){const e=r.data;g(c,e),c=null,m()}}function d(){$("#board-container").css("max-height",""),$("#board-container").css("max-width",""),$("div[class^=board-]").css("position","static"),b.resize();const r=.8*$(window).height();let e=$("#board").css("width");if(e=parseInt(e.substring(0,e.length-2)),e>r){const e=r+"px";$("#board-container").css("max-height",e),$("#board-container").css("max-width",e),b.resize()}$("#board > div > div").children().each((function(){$(this).children().each((function(){$(this).click($(this).attr("data-square"),h)}))}))}const b=new ChessBoard("board",{draggable:!0,dropOffBoard:"snapback",onDragStart:function(r,e,n,t){return v(r,e,n,t)},onDrop:g,position:"start",pieceTheme:"../img/{piece}.svg"}),m=()=>{$(".square-highlight").removeClass(s)},E=$("#message"),_=$("#status-2");function w(r){E.toggleClass(r),_.toggleClass(r)}function C(r){return"w"===r?"White":"Black"}const A=r=>{let e="w";for(let n=0;n<12;++n)e="w"===t(r+n)?"white":"black",$("#turn-"+n).css("background-color",e),$("#message-"+n).css("background-color",e)},S=r=>{E.html(r),_.html(r)};(()=>{const r=new o,e=(t,i,l)=>{if(null===r.move({from:t,to:i}))return"snapback";if(((r,e)=>{void 0===e&&(e=null!==c),b.position(r,e),m()})(r.fen().split(" ")[0],l),A(r.turnNum()),n(),!r.gameOver()&&"b"===r.activeColor()){const n=()=>{console.log("Thinking...");const n=parseInt($("#difficulty").find(":selected").val()),t=((r,e)=>{f=0;const n=(new Date).getTime(),t=function(r,e){const n=r.moves({verbose:!0});let t=[],i=-999999;a=void 0;const l=r.fen();a={fen:l,toMove:r.turnColor,val:0,children:[]};for(let l=0;l<n.length;++l){const f=n[l],s=o(r.fen());s.move(f);const c=u(s,e-1,-1e5,1e5,"w"===s.turnColor),p=c.val;a.children.push(c),p>i?(i=p,t=[f]):p===i&&t.push(f)}return a.val=i,console.log(a),t[Math.floor(Math.random()*t.length)]}(r,e),i=(new Date).getTime()-n,l=1e3*f/i;return console.log(`took ${i/1e3} seconds`),console.log("moves / sec",l),t})(r,n);e(t.from,t.to,!0)};window.setTimeout(n,1e3)}},n=()=>{const e=r.gameOver(),n=r.activeColor();if(e)switch(e){case r.CHECKMATE:(r=>{const e=C(r);S(`${e} checkmated`),w("bg-danger")})(n);break;case r.STALEMATE:S("Stalemate"),w("bg-danger");break;case r.DRAW:S("Draw"),w("bg-danger");break;case r.KING_TAKEN:S("King taken"),w("bg-danger");break;default:console.error("Reached unknown state")}else r.inCheck()?(r=>{const e=C(r);S(`${e} in check`),w("bg-warning text-dark")})(n):(S(""),E.toggleClass("bg-danger bg-warning text-dark",!1),_.toggleClass("bg-danger bg-warning text-dark",!1))},t=(n,t,o,i,a,l)=>{return n===t?(u=n,m(),c===u?c=null:(c=u,$(`[id^=${u}-]`).addClass(s)),"snapback"):r.legal({from:n,to:t})?e(n,t):"snapback";var u},i=(e,n,t,o)=>null===r.gameOver()&&n.includes(r.activeColor());window.app={init:()=>{var r;v=(r={onDragStart:i,onDrop:t}).onDragStart?r.onDragStart:v,p=r.onDrop?r.onDrop:p,d(),$(window).resize(d),A(0)}}})(),$((()=>{window.app.init()}))})()})();